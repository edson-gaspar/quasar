#!/usr/bin/env bash
set -euo pipefail # STRICT MODE
IFS=$'\n\t'       # http://redsymbol.net/articles/unofficial-bash-strict-mode/

function downloadMLRPM() {
  if [[ $1 =~ "marklogic" ]]
  then
    ./docker/Dockerfiles/Marklogic/getMLRpm
  fi
}

CONTAINER=$1
if [[ $CONTAINER == "quasar_spark_local_test" ]]
then
  echo "$CONTAINER: not starting a container for spark_local_test..."
else
  if [[ ${TRAVIS:-} ]]
  then
    cd $TRAVIS_BUILD_DIR
    downloadMLRPM $CONTAINER
    docker-compose -f ./docker/docker-compose.yml up -d $CONTAINER
    sleep 5
  else
    downloadMLRPM $CONTAINER
    docker-compose -f ./docker/docker-compose.yml up -d $CONTAINER
    sleep 5
  fi
fi
